language: go
sudo: required
dist: xenial

services:
- docker

install: scripts/setup-tools-for-ubuntu.sh

jobs:
  include:
  - stage: Tests
    name: Validate
    script:
    - make lint
  - name: Minikube
    script:
    - scripts/setup-minikube-for-linux.sh
    - make test CHARTS=enterprise-suite
  - name: Minikube - Latest
    script:
    - scripts/setup-minikube-for-linux.sh
    - make test CHARTS=enterprise-suite-latest
  - name: Reactive-sandbox test
    script:
    - make test CHARTS=reactive-sandbox

branches:
  only:
  - master

notifications:
  email: false
  slack:
    secure: Wbp33+rhtKSkDQsoBq33b3/WFk7/vzoKNqVoGhjFyXtBTE/mP/C7ZvGDxSWVLhbKTqCzlXpp3BlO9/g2PJa3GafssYr+ZRxYzkyXqQnjIUTFylSqKZky729LTtE8eBfreyjX1JZgVu0++kQTkUsQCjBEW0dhZsVSnd8QAQwQQigxue9/wPiZABOuoaZ4UCPoE7EzhRH86MO3RhRdfIMSOwj94cPf95NtN292jmOEsTCayc+CVfJ77wbbANAvqX2kBaBQTgREUk/0guR8bVTO8YxExuYkNEeQZRKa8TLjP9A3Gkd/JED6R3FLLw7EcT9J62zWLTKZqRKCb+Nhc01uy67/m21bVlHfphPgNAy3rU27lmVqzS0NCyiqix8uenoewjFYYbR8+3nTO+kuqeP/lRUmmINkzornICtx+POP+mGOSE4llmplZIhJKWBN1x/OtY9XvIXd1WcZtWnk310zurCN+0qjBIewjs4a28ZcZdB8e/si+Cx5YT2UvXgYZipjM3CX29AaPaCGsuGdjQJN/OFzYbwiJbvfI/O9OEl32aMfu1w4P3WtLNVT2eW6Kdu0HJaRKvtSwzKBmYP8b5xdTQemsG2R97rPN1uTOwVWwviOQgg/pycIxjNawMf6s+5I7CK3zO3QjwrfWSq7d8Nm2qC5J+82+rQSZ6YDr3wJliI=

deploy:
  provider: gcs
  access_key_id: GOOGISNJQ6EJ3V7HYVUXRT7C
  secret_access_key:
    secure: obSWAITkW2P21A4kosNbP/DG4sXRCZ1EP90J16oVjBFJxq5TZd8NYGhK7icBFLPDaaZcz3wb1ed38rnQ2dLzuKeNk18xmNLwvvPsXRMFzj6W6pdZ7zekLzwwMXCBYTZ5YjMShH+IJbSDyywWCLnE8vq4mucBY44BYPnl80DoQ6vLl2IgxR9DVV0R7Y2N+peP4nvlcHJoL0kqWuCgJuWP/Vj6QwTPUiLJ1Q0H0yPmv2RWtRWjf0qW5fXIMOO+C04Sq+dF096NJn+rU/1Qq664S9MHQRK42CurStCCIQ6iG5emd63+pozJGeej2ay5z4xUTO8/nYFaDkMEFsFRJdfY8263nYLsn3j7od7qa1uYz+K4SvkkXMqSyWwPC+KqmwXrG8MkK+o529dfmh3Mq5etNOzihEfDr3nfjeA23w9KH/mxkDCgGSLHfA6OWDvDV6YnKAQ5nZvsxCOcS5Q5b32+e3D7mxI3QmfQDF+l1INyuwtfzUZlkmegnccNUu3AUlWj/oEWzoB3+nxxgdJ0kctk4qd2BRO0dCqQtaWfd1ybiN8OT7hDcpqPtvWji9I0l7EcOo+KD7Nq9be5qrK6+qDyMB+ATpEEfdMQCrSVkvu8nmV1k8bfnunsom3dpMGEAqgLSep0teTVgALqoD6xYbXKxyMUgaEJs/2z/I7p2OX4G5I=
  bucket: marcoderama-test
  local-dir: docs
  on:
    repo: lightbend/helm-charts
